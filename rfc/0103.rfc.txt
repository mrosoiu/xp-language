RFC 0103: Coding standards adjustements for XP5
========================================================================
$Id$

@authors: friebe
@created: Wed Dec 20 12:48:40 CET 2006
@status: draft
@category: <infrastructure>

Scope of Change
---------------
Coding standards will be adjusted to the new language version.


Rationale
---------
- New keywords
- Modifiers


Functionality
-------------

References
~~~~~~~~~~
References are no longer needed and thus disallowed.


Method modifiers & API-Doc tags
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Because we have method modifiers the @access und @model tags will become
obsolete.

XP4:
<?php
  /**
   * Gets the Logger instance
   *
   * @model   static
   * @access  public
   * @return  &util.log.Logger
   */
  function &getInstance() {
    // ...
  }
?>

XP5:
<?php
  /**
   * Gets the Logger instance
   *
   * @return  util.log.Logger
   */
  public static function getInstance() {
    // ...
  }
?>

Please also note the reference have disappeared!


Method modifiers order
~~~~~~~~~~~~~~~~~~~~~~
Method modifiers should be given in the following order:

<pre>
  [access] static abstract final
</pre>

[access] is one on public, private or protected.

Examples:
<?php
  protected function __construct() { }
  public static function getInstance() { }
  public abstract function run();
  protected final function getMessage() { }
?>


Type hints
~~~~~~~~~~
In PHP5, type hints can be used to ensure types on method invocation. These
type hints include any type of object and the keyword "array". For scalar
types, the type hint must be omitted (supplying "string" as type hint will
make the engine try to look up a class called "string").

Type hints are optional.

Example:
<?php
  /**
   * Adds a test
   *
   * @param   Test t
   * @return  Test the added test
   */
  public function addTest(Test $t) { 
    $this->tests[]= $t;
    return $t;
  }
?>

If addTest() is called with - say - a Date object, an IllegalArgumentException
will be thrown (see RFC #0100).


Try / Throw / Catch Statements
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Because try, throw and catch are now supported by the language, the 
following changes are necessary:
<pre>
* The (); needs to be removed from try
* Because catch and throw are now real keywords, they require
  whitespace in front of the opening bracket
* throw does not require ().
</pre>

XP4:
<?php
  try(); {
    throw(new IllegalArgumentException('*BLAM*'));
  } if (catch('IllegalArgumentException', $e)) {
    // ...
  }
?>

XP5:
<?php
  try(); {
    throw new IllegalArgumentException('*BLAM*');
  } catch (IllegalArgumentException $e) {
    // ...
  }
?>


Security considerations
-----------------------
n/a


Speed impact
------------
n/a


Dependencies
------------
n/a


Related documents
-----------------
- http://xp-framework.net/devel/coding.html
  XP Coding standards

Comments
--------

<EOF>
