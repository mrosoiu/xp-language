% ********** Appendix 1 **********
\subsection{Java-Arrays in PHP}
\label{sec:app1:arrays}

Einen Sonderfall stellen Java-Arrays dar. Sie werden in PHP nicht durch ein \emph{TurpitudeJavaObject},
sondern durch eine weitere Klasse, das \emph{TurpitudeJavaArray} repr"asentiert. Ein solches Objekt bietet
haupts"achlich drei Methoden: \emph{getLength()} gibt die L"ange des Java-Arrays zur"uck, mit \emph{get()} 
l"asst sich ein Element des Arrays auslesen, und \emph{set()} erm"oglicht das Setzen eines Elementes:
\begin{lstlisting}[caption=Normaler Zugriff auf ein TurpitudeJavaArray]
$method = $class->findMethod(
    'getStringArray', 
    '()[Ljava/lang/String;');
$array = $instance->javaInvoke($method);
$length = $array->getLength();
$val = $array->get(0);
$array->set(0, 'test');
\end{lstlisting}
Zus"atzlich implementiert das \emph{TurpitudeJavaArray} das PHP-Interface \emph{ArrayAccess}, und erlaubt
dem Anwender somit den direkten Zugriff auf Elemente mittels des []-Operators:
\begin{lstlisting}[caption=Klammern-Operator]
$val = $array[0];
$array[0] = 'test';
\end{lstlisting}
Weiterhin implementiert die Klasse das Interface, \emph{IteratorAggregate}, und bietet folglich die Methode
\emph{getIterator()} an, die eine Instanz der Klasse \emph{TurpitudeJavaArrayIterator} zur"uckgibt, welches
wiederum das Interface \emph{Iterator} implementiert. Somit ist es m"oglich auf gewohnte Weise "uber
Java-Arrays zu iterieren:
\begin{lstlisting}[caption=Iterator]
$iterator = $array->getIterator();
while ($iterator->valid()) {
    $row = $iterator->current();
    $key = $iterator->key();
    var_dump($row);
    var_dump($key);
    $iterator->next();
}
\end{lstlisting}
Die Methoden des \emph{TurpitudeJavaArrayIterator} k"onnen allerdings nicht nur direkt aufgerufen werden,
wie Klassen die das Interface \emph{Iterator} implementieren kann auch er in einer \emph{foreach}-Schleife
verwendet werden:
\begin{lstlisting}[caption=Iterator in einer foreach-Schleife]
foreach($iterator as $key => $row) {
  var_dump($key);
  var_dump($row);
}
\end{lstlisting}

Der Quelltext dieses Beispieles befindet sich in der Datei \emph{ArraySample.java}, 
und kann mittels des Befehls \emph{make arrays} ausgef"uhrt werden. Der Quelltext der
verwendeten Beispielklasse befindet sich in der Datei \emph{ExampleClass.java}.

% ********** End of appendix **********
